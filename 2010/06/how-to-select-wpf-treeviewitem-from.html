<html><head><title>@elentok - </title><style type="text/css">body {
  font-family: sans-serif;
  background: #242424;
  color: #e9e9e9;
  font-size: 18px;
  line-height: 1.5;
}

pre, code {
  font-family: 'Source Code Pro';
}

pre {
  padding: 15px;
  background-color: #121212;
  border-radius: 5px;
  line-height: 1.3;
}

a, a:visited {
  color: #98adec;
}

.e-page {
  margin: auto;
  max-width: 700px;
}</style></head><body><div class="e-page"><a class="e-header" href="/"><div class="e-header__avatar"><div class="e-avatar"></div></div><h1>Elentok's Blog</h1></a><h2>How to select a WPF TreeViewItem from code</h2><div><p>I&#39;ve been breaking for a couple of hours now on how to select an tree view item properly by code. I&#39;m using the ViewModel&#39;s &quot;IsSelected&quot; property which is databinded to the TreeViewItem&#39;s &quot;IsSelected&quot; property, but I&#39;ve now realized that it&#39;s not enough...</p>
<p>Some googling brought me to this <a href="http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/61a062ef-058f-43ea-ad18-3d08e6bd8765">MSDN forum post</a>, and apparently the problem is that only selecting the TreeViewItem causes problems, what you need to do is also focus it, and the simple of doing that (according to the post) is this:</p>
<p>In the XAML subscribe to the &quot;TreeViewItem.Selected&quot; event:</p>
<pre><TreeView TreeViewItem.Selected="TreeViewItem_Selected" />
</pre>

<p>And in the code-behind handle it like this:</p>
<pre>private void TreeViewItem_Selected(object sender, RoutedEventArgs e)
  {
    TreeViewItem item = e.OriginalSource as TreeViewItem;
    if (item != null && !item.IsFocused)
      item.Focus();
  }
</pre></div></div><style type="text/css">@import "/style.css";
@import url('https://fonts.googleapis.com/css?family=Open+Sans|Source+Code+Pro');</style></body></html>