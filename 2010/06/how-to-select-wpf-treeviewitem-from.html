<html><head><meta charSet="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"/><title>How to select a WPF TreeViewItem from code | David Elentok&#x27;s Blog</title><meta property="og:title" content="How to select a WPF TreeViewItem from code"/><meta property="og:description"/><meta property="og:type" content="article"/><meta property="og:image"/><meta property="og:url" content="https://blog.elentok.com/2010/06/how-to-select-wpf-treeviewitem-from.html"/><meta property="og:site_name" content="David Elentok&#x27;s Blog"/><meta name="twitter:card" content="summary"/><meta name="twitter:site" content="@elentok"/><meta name="twitter:title" content="How to select a WPF TreeViewItem from code"/><meta name="twitter:image" content="https://blog.elentok.com/avatar-og.png"/><meta name="twitter:description"/><style type="text/css">
      body {
        font-family: sans-serif;
        background: #242424;
        color: #e9e9e9;
        font-size: 18px;
        line-height: 1.5;
      }

      a, a:visited {
        color: #98adec;
      }

      a:hover {
        color: #c5d2f9;
      }

      .e-container {
        margin: auto;
        max-width: 700px;
        padding: 15px;
      }
      </style></head><body><div class="e-container"><a class="e-header" href="/"><div class="e-header__avatar"><div class="e-avatar"></div></div><h2>Elentok&#x27;s Blog</h2></a><div class="e-about-me"><a href="http://elentok.com">About me</a></div><div class="e-post e-post--full"><h1 class="e-post__title">How to select a WPF TreeViewItem from code</h1><div class="e-post__date">June 3, 2010</div><div class="e-post__tags"><a class="e-post-tag" href="/tags/treeview.html">treeview</a><a class="e-post-tag" href="/tags/tips.html">tips</a><a class="e-post-tag" href="/tags/wpf.html">wpf</a></div><div class="e-post__body"><p>I&#x27;ve been breaking for a couple of hours now on how to select an tree view item
properly by code. I&#x27;m using the ViewModel&#x27;s &quot;IsSelected&quot; property which is
databinded to the TreeViewItem&#x27;s &quot;IsSelected&quot; property, but I&#x27;ve now realized
that it&#x27;s not enough...</p>
<p>Some googling brought me to this <a href="http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/61a062ef-058f-43ea-ad18-3d08e6bd8765">MSDN forum post</a>, and apparently the
problem is that only selecting the TreeViewItem causes problems, what you need
to do is also focus it, and the simple of doing that (according to the post) is
this:</p>
<p>In the XAML subscribe to the <code>TreeViewItem.Selected</code> event:</p>
<pre><div style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-xml" style="white-space:pre;background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:hsl(220, 14%, 71%)">&lt;</span><span class="token" style="color:hsl(355, 65%, 65%)">TreeView</span><span class="token" style="color:hsl(355, 65%, 65%)"> </span><span class="token" style="color:hsl(29, 54%, 61%)">TreeViewItem.Selected</span><span class="token" style="color:hsl(220, 14%, 71%)">=</span><span class="token" style="color:hsl(220, 14%, 71%)">&quot;</span><span class="token" style="color:hsl(95, 38%, 62%)">TreeViewItem_Selected</span><span class="token" style="color:hsl(220, 14%, 71%)">&quot;</span><span class="token" style="color:hsl(355, 65%, 65%)"> </span><span class="token" style="color:hsl(220, 14%, 71%)">/&gt;</span></code></div></pre>
<p>And in the code-behind handle it like this:</p>
<pre><div style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-cs" style="white-space:pre;background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:hsl(286, 60%, 67%)">private</span><span> </span><span class="token return-type" style="color:hsl(286, 60%, 67%)">void</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">TreeViewItem_Selected</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(286, 60%, 67%)">object</span><span> sender</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">RoutedEventArgs</span><span> e</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span></span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>
</span><span>  </span><span class="token" style="color:hsl(29, 54%, 61%)">TreeViewItem</span><span> item </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> e</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>OriginalSource </span><span class="token" style="color:hsl(286, 60%, 67%)">as</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">TreeViewItem</span><span class="token" style="color:hsl(220, 14%, 71%)">;</span><span>
</span><span>  </span><span class="token" style="color:hsl(286, 60%, 67%)">if</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>item </span><span class="token" style="color:hsl(207, 82%, 66%)">!=</span><span> </span><span class="token" style="color:hsl(286, 60%, 67%)">null</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">&amp;&amp;</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">!</span><span>item</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>IsFocused</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>
</span><span>    item</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span class="token" style="color:hsl(207, 82%, 66%)">Focus</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">;</span><span>
</span><span>  </span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>
</span><span></span><span class="token" style="color:hsl(220, 14%, 71%)">}</span></code></div></pre></div></div><div class="e-post__next"><span>Next:</span><a class="e-post__next" href="/2010/04/how-to-use-your-ipod-touch-as-alarm.html">How to use your iPod Touch as an alarm clock</a></div></div><style type="text/css">
          @import "/style.css";
          @import url('https://fonts.googleapis.com/css?family=Open+Sans:400,700|Source+Code+Pro');
          </style></body></html>