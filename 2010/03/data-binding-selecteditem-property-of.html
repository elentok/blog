<html><head><meta charSet="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"/><title>Data-binding the SelectedItem property of the WPF TreeView | David Elentok&#x27;s Blog</title><meta property="og:title" content="Data-binding the SelectedItem property of the WPF TreeView"/><meta property="og:description"/><meta property="og:type" content="article"/><meta property="og:image"/><meta property="og:url" content="https://blog.elentok.com/2010/03/data-binding-selecteditem-property-of.html"/><meta property="og:site_name" content="David Elentok&#x27;s Blog"/><meta name="twitter:card" content="summary"/><meta name="twitter:site" content="@elentok"/><meta name="twitter:title" content="Data-binding the SelectedItem property of the WPF TreeView"/><meta name="twitter:image" content="https://blog.elentok.com/avatar-og.png"/><meta name="twitter:description"/><style type="text/css">
      body {
        font-family: sans-serif;
        background: #242424;
        color: #e9e9e9;
        font-size: 18px;
        line-height: 1.5;
      }

      a, a:visited {
        color: #98adec;
      }

      a:hover {
        color: #c5d2f9;
      }

      .e-container {
        margin: auto;
        max-width: 700px;
        padding: 15px;
      }
      </style><style type="text/css">
          @import "/style.css";
          @import url('https://fonts.googleapis.com/css?family=Open+Sans:400,700|Open+Sans+Condensed:300|Source+Code+Pro');
          </style></head><body><div class="e-container"><a class="e-header" href="/"><div class="e-header__avatar"><div class="e-avatar"></div></div><h2>David Elentok&#x27;s Blog</h2></a><div class="e-about-me"><a href="http://elentok.com">About me</a></div><div class="e-post e-post--full"><h1 class="e-post__title">Data-binding the SelectedItem property of the WPF TreeView</h1><div class="e-post__date">March 20, 2010</div><div class="e-post__tags"><a class="e-post-tag" href="/tags/tips.html">tips</a><a class="e-post-tag" href="/tags/wpf.html">wpf</a></div><div class="e-post__body"><p>In a new WPF application I&#x27;m writing I needed to bind the &quot;SelectedItem&quot;
property of the TreeView control to the &quot;SelectedItem&quot; property of its
<a href="http://blogs.msdn.com/dphill/archive/2009/01/31/the-viewmodel-pattern.aspx">ViewModel</a>; but, alas, the TreeView&#x27;s &quot;SelectedItem&quot; property is
read-only...</p>
<p>After some googling I found the <a href="http://www.codeproject.com/KB/WPF/versatile_treeview.aspx">Versatile TreeView</a> by Philip Sumi which
adds the property I wanted, but since I&#x27;m learning WPF and want a deeper
understanding I decided to write my own (and use Philip&#x27;s TreeView as
reference).</p>
<p>In the code I noticed a lot of dependency properties, and I figured its time to
learn what are dependency properties and how do they work; again, some googling
brought me to <a href="http://www.switchonthecode.com/tutorials/wpf-tutorial-introduction-to-dependency-properties">this post</a> which I think gives a very good explanation of
dependency properties.</p>
<p>Now that I knew what I had to do, I started writing the <code>EnhancedTreeView</code> class
(which is based on the TreeView class).</p>
<p>At first I thought about overriding the <code>SelectedItem</code> property but it didn&#x27;t go
very smooth so I added the <code>SelectedObject</code> property.</p>
<p>I added a callback to the dependency-property-changed event (see
<code>SelectedObjectChangedCallback</code>) and when the property was changed I needed to
change the selected item; but, alas again!, the selected item is
read-only...</p>
<p>Some more googling brought me to this <a href="http://quickduck.com/blog/2008/12/11/selecting-an-item-in-a-treeview-in-wpf/">blog post</a> which uses the
<code>ItemsContainerGenerator</code> to find the matching <code>TreeViewItem</code> for the object I
want to select.</p>
<p>And here&#x27;s the final code:</p>
<pre><div style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-cs" style="white-space:pre;background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token doc-comment" style="color:hsl(220, 10%, 40%);font-style:italic">/// </span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&lt;</span><span class="token doc-comment" style="color:hsl(355, 65%, 65%);font-style:italic">summary</span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&gt;</span><span>
</span><span></span><span class="token doc-comment" style="color:hsl(220, 10%, 40%);font-style:italic">/// This treeview class allows databinding the</span><span>
</span><span></span><span class="token doc-comment" style="color:hsl(220, 10%, 40%);font-style:italic">/// &quot;SelectedObject&quot; property</span><span>
</span><span></span><span class="token doc-comment" style="color:hsl(220, 10%, 40%);font-style:italic">/// </span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&lt;/</span><span class="token doc-comment" style="color:hsl(355, 65%, 65%);font-style:italic">summary</span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&gt;</span><span>
</span><span></span><span class="token" style="color:hsl(286, 60%, 67%)">public</span><span> </span><span class="token" style="color:hsl(286, 60%, 67%)">class</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">EnhancedTreeView</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">:</span><span> </span><span class="token type-list" style="color:hsl(29, 54%, 61%)">TreeView</span><span>
</span><span></span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>
</span><span>  </span><span class="token preprocessor" style="color:hsl(355, 65%, 65%)">#</span><span class="token preprocessor directive" style="color:hsl(286, 60%, 67%)">region</span><span class="token preprocessor" style="color:hsl(355, 65%, 65%)"> SelectedObject</span><span>
</span>
<span>  </span><span class="token doc-comment" style="color:hsl(220, 10%, 40%);font-style:italic">/// </span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&lt;</span><span class="token doc-comment" style="color:hsl(355, 65%, 65%);font-style:italic">summary</span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&gt;</span><span>
</span><span>  </span><span class="token doc-comment" style="color:hsl(220, 10%, 40%);font-style:italic">/// The dependency property that allows use to bind the</span><span>
</span><span>  </span><span class="token doc-comment" style="color:hsl(220, 10%, 40%);font-style:italic">/// &quot;SelectedObject&quot; property</span><span>
</span><span>  </span><span class="token doc-comment" style="color:hsl(220, 10%, 40%);font-style:italic">/// </span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&lt;/</span><span class="token doc-comment" style="color:hsl(355, 65%, 65%);font-style:italic">summary</span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&gt;</span><span>
</span><span>  </span><span class="token" style="color:hsl(286, 60%, 67%)">public</span><span> </span><span class="token" style="color:hsl(286, 60%, 67%)">static</span><span> </span><span class="token" style="color:hsl(286, 60%, 67%)">readonly</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">DependencyProperty</span><span>
</span><span>    SelectedObjectProperty </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span>
</span><span>      DependencyProperty</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span class="token" style="color:hsl(207, 82%, 66%)">Register</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>
</span><span>        </span><span class="token" style="color:hsl(95, 38%, 62%)">&quot;SelectedObject&quot;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span>
</span><span>        </span><span class="token" style="color:hsl(286, 60%, 67%)">typeof</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token type-expression" style="color:hsl(286, 60%, 67%)">object</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span>
</span><span>        </span><span class="token" style="color:hsl(286, 60%, 67%)">typeof</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token type-expression" style="color:hsl(29, 54%, 61%)">EnhancedTreeView</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span>
</span><span>        </span><span class="token" style="color:hsl(286, 60%, 67%)">new</span><span> </span><span class="token constructor-invocation" style="color:hsl(29, 54%, 61%)">PropertyMetadata</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>SelectedObjectChangedCallback</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">;</span><span>
</span>
<span>  </span><span class="token doc-comment" style="color:hsl(220, 10%, 40%);font-style:italic">/// </span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&lt;</span><span class="token doc-comment" style="color:hsl(355, 65%, 65%);font-style:italic">summary</span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&gt;</span><span>
</span><span>  </span><span class="token doc-comment" style="color:hsl(220, 10%, 40%);font-style:italic">/// Gets or sets the select object (a writable version of</span><span>
</span><span>  </span><span class="token doc-comment" style="color:hsl(220, 10%, 40%);font-style:italic">/// the &quot;SelectedItem&quot; property)</span><span>
</span><span>  </span><span class="token doc-comment" style="color:hsl(220, 10%, 40%);font-style:italic">/// </span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&lt;/</span><span class="token doc-comment" style="color:hsl(355, 65%, 65%);font-style:italic">summary</span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&gt;</span><span>
</span><span>  </span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span class="token" style="color:hsl(207, 82%, 66%)">Bindable</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(29, 54%, 61%)">true</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span>
</span><span>  </span><span class="token" style="color:hsl(286, 60%, 67%)">public</span><span> </span><span class="token return-type" style="color:hsl(286, 60%, 67%)">object</span><span> SelectedObject
</span><span>  </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>
</span><span>    </span><span class="token" style="color:hsl(286, 60%, 67%)">get</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span> </span><span class="token" style="color:hsl(286, 60%, 67%)">return</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">GetValue</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>SelectedObjectProperty</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">;</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>
</span><span>    </span><span class="token" style="color:hsl(286, 60%, 67%)">set</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">SetValue</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>SelectedObjectProperty</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(286, 60%, 67%)">value</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">;</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>
</span><span>  </span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>
</span>
<span>  </span><span class="token doc-comment" style="color:hsl(220, 10%, 40%);font-style:italic">/// </span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&lt;</span><span class="token doc-comment" style="color:hsl(355, 65%, 65%);font-style:italic">summary</span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&gt;</span><span>
</span><span>  </span><span class="token doc-comment" style="color:hsl(220, 10%, 40%);font-style:italic">/// This method is called whenever ever the selected</span><span>
</span><span>  </span><span class="token doc-comment" style="color:hsl(220, 10%, 40%);font-style:italic">/// object is changed, and if it was changed from the</span><span>
</span><span>  </span><span class="token doc-comment" style="color:hsl(220, 10%, 40%);font-style:italic">/// outside, this method will set the selected item.</span><span>
</span><span>  </span><span class="token doc-comment" style="color:hsl(220, 10%, 40%);font-style:italic">/// </span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&lt;/</span><span class="token doc-comment" style="color:hsl(355, 65%, 65%);font-style:italic">summary</span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&gt;</span><span>
</span><span>  </span><span class="token doc-comment" style="color:hsl(220, 10%, 40%);font-style:italic">/// </span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&lt;</span><span class="token doc-comment" style="color:hsl(355, 65%, 65%);font-style:italic">param</span><span class="token doc-comment" style="color:hsl(355, 65%, 65%);font-style:italic"> </span><span class="token doc-comment" style="color:hsl(29, 54%, 61%);font-style:italic">name</span><span class="token doc-comment" style="color:hsl(95, 38%, 62%);font-style:italic">=</span><span class="token doc-comment" style="color:hsl(95, 38%, 62%);font-style:italic">&quot;</span><span class="token doc-comment" style="color:hsl(95, 38%, 62%);font-style:italic">obj</span><span class="token doc-comment" style="color:hsl(95, 38%, 62%);font-style:italic">&quot;</span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&gt;</span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&lt;/</span><span class="token doc-comment" style="color:hsl(355, 65%, 65%);font-style:italic">param</span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&gt;</span><span>
</span><span>  </span><span class="token doc-comment" style="color:hsl(220, 10%, 40%);font-style:italic">/// </span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&lt;</span><span class="token doc-comment" style="color:hsl(355, 65%, 65%);font-style:italic">param</span><span class="token doc-comment" style="color:hsl(355, 65%, 65%);font-style:italic"> </span><span class="token doc-comment" style="color:hsl(29, 54%, 61%);font-style:italic">name</span><span class="token doc-comment" style="color:hsl(95, 38%, 62%);font-style:italic">=</span><span class="token doc-comment" style="color:hsl(95, 38%, 62%);font-style:italic">&quot;</span><span class="token doc-comment" style="color:hsl(95, 38%, 62%);font-style:italic">eventArgs</span><span class="token doc-comment" style="color:hsl(95, 38%, 62%);font-style:italic">&quot;</span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&gt;</span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&lt;/</span><span class="token doc-comment" style="color:hsl(355, 65%, 65%);font-style:italic">param</span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&gt;</span><span>
</span><span>  </span><span class="token" style="color:hsl(286, 60%, 67%)">private</span><span> </span><span class="token" style="color:hsl(286, 60%, 67%)">static</span><span> </span><span class="token return-type" style="color:hsl(286, 60%, 67%)">void</span><span> SelectedObjectChangedCallback
</span><span>    </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(29, 54%, 61%)">DependencyObject</span><span> obj</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span>
</span><span>     </span><span class="token" style="color:hsl(29, 54%, 61%)">DependencyPropertyChangedEventArgs</span><span> eventArgs</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>  </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>
</span><span>    </span><span class="token" style="color:hsl(29, 54%, 61%)">EnhancedTreeView</span><span> treeView </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>EnhancedTreeView</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>obj</span><span class="token" style="color:hsl(220, 14%, 71%)">;</span><span>
</span><span>    </span><span class="token" style="color:hsl(286, 60%, 67%)">if</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(207, 82%, 66%)">!</span><span class="token" style="color:hsl(207, 82%, 66%)">ReferenceEquals</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>treeView</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>SelectedItem</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span>
</span><span>          eventArgs</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>NewValue</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>      </span><span class="token" style="color:hsl(207, 82%, 66%)">SelectItem</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>treeView</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> eventArgs</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>NewValue</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">;</span><span>
</span><span>  </span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>
</span>
<span>  </span><span class="token preprocessor" style="color:hsl(355, 65%, 65%)">#</span><span class="token preprocessor directive" style="color:hsl(286, 60%, 67%)">endregion</span><span>
</span>
<span>  </span><span class="token doc-comment" style="color:hsl(220, 10%, 40%);font-style:italic">/// </span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&lt;</span><span class="token doc-comment" style="color:hsl(355, 65%, 65%);font-style:italic">summary</span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&gt;</span><span>
</span><span>  </span><span class="token doc-comment" style="color:hsl(220, 10%, 40%);font-style:italic">/// Searches the given item in the parent (recursively)</span><span>
</span><span>  </span><span class="token doc-comment" style="color:hsl(220, 10%, 40%);font-style:italic">/// and selects it, returns true if the item was found</span><span>
</span><span>  </span><span class="token doc-comment" style="color:hsl(220, 10%, 40%);font-style:italic">/// and selected, false otherwise.</span><span>
</span><span>  </span><span class="token doc-comment" style="color:hsl(220, 10%, 40%);font-style:italic">/// </span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&lt;/</span><span class="token doc-comment" style="color:hsl(355, 65%, 65%);font-style:italic">summary</span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&gt;</span><span>
</span><span>  </span><span class="token doc-comment" style="color:hsl(220, 10%, 40%);font-style:italic">/// </span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&lt;</span><span class="token doc-comment" style="color:hsl(355, 65%, 65%);font-style:italic">param</span><span class="token doc-comment" style="color:hsl(355, 65%, 65%);font-style:italic"> </span><span class="token doc-comment" style="color:hsl(29, 54%, 61%);font-style:italic">name</span><span class="token doc-comment" style="color:hsl(95, 38%, 62%);font-style:italic">=</span><span class="token doc-comment" style="color:hsl(95, 38%, 62%);font-style:italic">&quot;</span><span class="token doc-comment" style="color:hsl(95, 38%, 62%);font-style:italic">parent</span><span class="token doc-comment" style="color:hsl(95, 38%, 62%);font-style:italic">&quot;</span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&gt;</span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&lt;/</span><span class="token doc-comment" style="color:hsl(355, 65%, 65%);font-style:italic">param</span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&gt;</span><span>
</span><span>  </span><span class="token doc-comment" style="color:hsl(220, 10%, 40%);font-style:italic">/// </span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&lt;</span><span class="token doc-comment" style="color:hsl(355, 65%, 65%);font-style:italic">param</span><span class="token doc-comment" style="color:hsl(355, 65%, 65%);font-style:italic"> </span><span class="token doc-comment" style="color:hsl(29, 54%, 61%);font-style:italic">name</span><span class="token doc-comment" style="color:hsl(95, 38%, 62%);font-style:italic">=</span><span class="token doc-comment" style="color:hsl(95, 38%, 62%);font-style:italic">&quot;</span><span class="token doc-comment" style="color:hsl(95, 38%, 62%);font-style:italic">itemToSelect</span><span class="token doc-comment" style="color:hsl(95, 38%, 62%);font-style:italic">&quot;</span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&gt;</span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&lt;/</span><span class="token doc-comment" style="color:hsl(355, 65%, 65%);font-style:italic">param</span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&gt;</span><span>
</span><span>  </span><span class="token doc-comment" style="color:hsl(220, 10%, 40%);font-style:italic">/// </span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&lt;</span><span class="token doc-comment" style="color:hsl(355, 65%, 65%);font-style:italic">returns</span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&gt;</span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&lt;/</span><span class="token doc-comment" style="color:hsl(355, 65%, 65%);font-style:italic">returns</span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&gt;</span><span>
</span><span>  </span><span class="token" style="color:hsl(286, 60%, 67%)">private</span><span> </span><span class="token" style="color:hsl(286, 60%, 67%)">static</span><span> </span><span class="token return-type" style="color:hsl(286, 60%, 67%)">bool</span><span> SelectItem
</span><span>    </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(29, 54%, 61%)">ItemsControl</span><span> parent</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> </span><span class="token" style="color:hsl(286, 60%, 67%)">object</span><span> itemToSelect</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>  </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>
</span><span>    </span><span class="token" style="color:hsl(286, 60%, 67%)">var</span><span> childTreeNode </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span>
</span><span>      parent</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>ItemContainerGenerator
</span><span>        </span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span class="token" style="color:hsl(207, 82%, 66%)">ContainerFromItem</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>itemToSelect</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>      </span><span class="token" style="color:hsl(286, 60%, 67%)">as</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">TreeViewItem</span><span class="token" style="color:hsl(220, 14%, 71%)">;</span><span>
</span>
<span>    </span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic">// if the item to select is directly under &quot;parent&quot;,</span><span>
</span><span>    </span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic">// just select it</span><span>
</span><span>    </span><span class="token" style="color:hsl(286, 60%, 67%)">if</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>childTreeNode </span><span class="token" style="color:hsl(207, 82%, 66%)">!=</span><span> </span><span class="token" style="color:hsl(286, 60%, 67%)">null</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>    </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>
</span><span>      childTreeNode</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span class="token" style="color:hsl(207, 82%, 66%)">Focus</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">;</span><span>
</span><span>      </span><span class="token" style="color:hsl(286, 60%, 67%)">return</span><span> childTreeNode</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>IsSelected </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">true</span><span class="token" style="color:hsl(220, 14%, 71%)">;</span><span>
</span><span>    </span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>
</span>
<span>    </span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic">// if the item to select is not directly under &quot;parent&quot;,</span><span>
</span><span>    </span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic">// search the child nodes of &quot;parent&quot;</span><span>
</span><span>    </span><span class="token" style="color:hsl(286, 60%, 67%)">if</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>parent</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>Items</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>Count </span><span class="token" style="color:hsl(207, 82%, 66%)">&gt;</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">0</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>    </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>
</span><span>      </span><span class="token" style="color:hsl(286, 60%, 67%)">foreach</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(286, 60%, 67%)">object</span><span> childItem </span><span class="token" style="color:hsl(286, 60%, 67%)">in</span><span> parent</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>Items</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>      </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>
</span><span>        </span><span class="token" style="color:hsl(286, 60%, 67%)">var</span><span> childItemsControl </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span>
</span><span>          parent</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>ItemContainerGenerator
</span><span>            </span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span class="token" style="color:hsl(207, 82%, 66%)">ContainerFromItem</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>childItem</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>          </span><span class="token" style="color:hsl(286, 60%, 67%)">as</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">ItemsControl</span><span class="token" style="color:hsl(220, 14%, 71%)">;</span><span>
</span>
<span>        </span><span class="token" style="color:hsl(286, 60%, 67%)">if</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(207, 82%, 66%)">SelectItem</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>childItemsControl</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> itemToSelect</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>          </span><span class="token" style="color:hsl(286, 60%, 67%)">return</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">true</span><span class="token" style="color:hsl(220, 14%, 71%)">;</span><span>
</span><span>      </span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>
</span><span>    </span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>
</span>
<span>    </span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic">// if the given item wasn&#x27;t found here:</span><span>
</span><span>    </span><span class="token" style="color:hsl(286, 60%, 67%)">return</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">false</span><span class="token" style="color:hsl(220, 14%, 71%)">;</span><span>
</span><span>  </span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>
</span>
<span>  </span><span class="token doc-comment" style="color:hsl(220, 10%, 40%);font-style:italic">/// </span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&lt;</span><span class="token doc-comment" style="color:hsl(355, 65%, 65%);font-style:italic">summary</span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&gt;</span><span>
</span><span>  </span><span class="token doc-comment" style="color:hsl(220, 10%, 40%);font-style:italic">/// When the selected item is updated from inside the tree,</span><span>
</span><span>  </span><span class="token doc-comment" style="color:hsl(220, 10%, 40%);font-style:italic">/// this method will update the &quot;SelectedObject&quot; property.</span><span>
</span><span>  </span><span class="token doc-comment" style="color:hsl(220, 10%, 40%);font-style:italic">/// </span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&lt;/</span><span class="token doc-comment" style="color:hsl(355, 65%, 65%);font-style:italic">summary</span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&gt;</span><span>
</span><span>  </span><span class="token doc-comment" style="color:hsl(220, 10%, 40%);font-style:italic">/// </span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&lt;</span><span class="token doc-comment" style="color:hsl(355, 65%, 65%);font-style:italic">param</span><span class="token doc-comment" style="color:hsl(355, 65%, 65%);font-style:italic"> </span><span class="token doc-comment" style="color:hsl(29, 54%, 61%);font-style:italic">name</span><span class="token doc-comment" style="color:hsl(95, 38%, 62%);font-style:italic">=</span><span class="token doc-comment" style="color:hsl(95, 38%, 62%);font-style:italic">&quot;</span><span class="token doc-comment" style="color:hsl(95, 38%, 62%);font-style:italic">e</span><span class="token doc-comment" style="color:hsl(95, 38%, 62%);font-style:italic">&quot;</span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&gt;</span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&lt;/</span><span class="token doc-comment" style="color:hsl(355, 65%, 65%);font-style:italic">param</span><span class="token doc-comment" style="color:hsl(220, 14%, 71%);font-style:italic">&gt;</span><span>
</span><span>  </span><span class="token" style="color:hsl(286, 60%, 67%)">protected</span><span> </span><span class="token" style="color:hsl(286, 60%, 67%)">override</span><span> </span><span class="token return-type" style="color:hsl(286, 60%, 67%)">void</span><span> OnSelectedItemChanged
</span><span>    </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(29, 54%, 61%)">RoutedPropertyChangedEventArgs</span><span class="token" style="color:hsl(220, 14%, 71%)">&lt;</span><span class="token" style="color:hsl(286, 60%, 67%)">object</span><span class="token" style="color:hsl(220, 14%, 71%)">&gt;</span><span> e</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span>  </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>
</span><span>    </span><span class="token" style="color:hsl(286, 60%, 67%)">this</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>SelectedObject </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> e</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span>NewValue</span><span class="token" style="color:hsl(220, 14%, 71%)">;</span><span>
</span>
<span>    </span><span class="token" style="color:hsl(286, 60%, 67%)">base</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span class="token" style="color:hsl(207, 82%, 66%)">OnSelectedItemChanged</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>e</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">;</span><span>
</span><span>  </span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>
</span><span></span><span class="token" style="color:hsl(220, 14%, 71%)">}</span></code></div></pre>
<p>To use the EnhancedTreeView all you need is to bind the <code>SelectedObject</code>
property:</p>
<pre><div style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0.5em 0;overflow:auto;border-radius:0.3em"><code class="language-xml" style="white-space:pre;background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:hsl(220, 14%, 71%)">&lt;</span><span class="token" style="color:hsl(355, 65%, 65%);-opacity:0.8">controls:</span><span class="token" style="color:hsl(355, 65%, 65%)">EnhancedTreeView</span><span class="token" style="color:hsl(355, 65%, 65%)">
</span><span class="token" style="color:hsl(355, 65%, 65%)">  </span><span class="token" style="color:hsl(29, 54%, 61%)">SelectedObject</span><span class="token" style="color:hsl(220, 14%, 71%)">=</span><span class="token" style="color:hsl(220, 14%, 71%)">&quot;</span><span class="token" style="color:hsl(95, 38%, 62%)">{Binding SelectedObject, Mode=TwoWay}</span><span class="token" style="color:hsl(220, 14%, 71%)">&quot;</span><span class="token" style="color:hsl(355, 65%, 65%)">
</span><span class="token" style="color:hsl(355, 65%, 65%)">  </span><span class="token" style="color:hsl(29, 54%, 61%)">ItemsSource</span><span class="token" style="color:hsl(220, 14%, 71%)">=</span><span class="token" style="color:hsl(220, 14%, 71%)">&quot;</span><span class="token" style="color:hsl(95, 38%, 62%)">...</span><span class="token" style="color:hsl(220, 14%, 71%)">&quot;</span><span class="token" style="color:hsl(355, 65%, 65%)"> </span><span class="token" style="color:hsl(220, 14%, 71%)">/&gt;</span></code></div></pre>
<p>It&#x27;s important to add <code>Mode=TwoWay</code> to the binding, otherwise it won&#x27;t work.</p></div></div><div class="e-post__next"><span>Next:</span><a class="e-post__next" href="/2010/03/3-pane-layout-in-wpf.html">3-Pane Layout in WPF</a></div></div></body></html>