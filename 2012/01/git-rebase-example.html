<html><head><meta charSet="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"/><title>Git Rebase Example | David Elentok&#x27;s Blog</title><meta property="og:title" content="Git Rebase Example"/><meta property="og:description"/><meta property="og:type" content="article"/><meta property="og:image"/><meta property="og:url" content="https://blog.elentok.com/2012/01/git-rebase-example.html"/><meta property="og:site_name" content="David Elentok&#x27;s Blog"/><meta name="twitter:card" content="summary"/><meta name="twitter:site" content="@elentok"/><meta name="twitter:title" content="Git Rebase Example"/><meta name="twitter:image" content="https://blog.elentok.com/avatar-og.png"/><meta name="twitter:description"/><style type="text/css">
      body {
        font-family: sans-serif;
        background: #242424;
        color: #e9e9e9;
        font-size: 18px;
        line-height: 1.5;
      }

      a, a:visited {
        color: #98adec;
      }

      a:hover {
        color: #c5d2f9;
      }

      .e-container {
        margin: auto;
        max-width: 700px;
        padding: 15px;
      }
      </style><style type="text/css">
          @import "/style.css";
          @import url('https://fonts.googleapis.com/css?family=Open+Sans:400,700|Open+Sans+Condensed:300|Source+Code+Pro');
          </style></head><body><div class="e-container"><a class="e-header" href="/"><div class="e-header__avatar"><div class="e-avatar"></div></div><h2>David Elentok&#x27;s Blog</h2></a><div class="e-about-me"><a href="http://elentok.com">About me</a></div><div class="e-post e-post--full"><h1 class="e-post__title">Git Rebase Example</h1><div class="e-post__date">January 29, 2012</div><div class="e-post__tags"><a class="e-post-tag" href="/tags/tutorial.html">tutorial</a><a class="e-post-tag" href="/tags/programming.html">programming</a><a class="e-post-tag" href="/tags/guide.html">guide</a><a class="e-post-tag" href="/tags/git.html">git</a></div><div class="e-post__body"><h2 id="what-is-rebase">What is rebase?</h2>
<p>Rebase means taking commits to made to an older revision of a branch and applying them to a newer
revision of that branch (usually when the origin branch has changed while we were commiting).</p>
<p>Rebase is an alternative for merge, it&#x27;s main advantage over merging is that it allows you to
maintain a clean linear history.</p>
<h2 id="example">Example</h2>
<p>Let&#x27;s look at this scenario:</p>
<ol>
<li>
<p><span style="color:#6262c5" node="[object Object]">Gaaa</span> and <span style="color:#24d024" node="[object Object]">Gaaa</span> both
clone the same repository. At the moment of cloning the repository had 2 commits:</p>
<pre style="color:#6262c5">  $ git log

  19abe80 - **(HEAD, master)** added file2
  8cb6ba4 - added file1
</pre>
</li>
<li>
<p><span style="color:#24d024" node="[object Object]">Gaaa</span> works on the project and makes two commits, so his
repository looks like this:</p>
<pre style="color:#24d024">  $ git log

  07c8c6d - **(HEAD, master)** added file4 <userb>
  e404363 - added file3 <userb>
  19abe80 - **(origin/master, origin/HEAD)** added file2
  8cb6ba4 - added file1
</userb></userb></pre>
<p>As you can see, <span style="color:#24d024" node="[object Object]">Gaaa</span>&#x27;s master branch is ahead of
&#x27;origin/master&#x27; by 2 commits (&#x27;origin/master&#x27; is the master branch in the origin repository).</p>
</li>
<li>
<p><span style="color:#24d024" node="[object Object]">Gaaa</span> pushes the changes to origin (the original
repository):</p>
<pre style="color:#24d024">  $ git push
  $ git log

  07c8c6d - **(HEAD, origin/master, origin/HEAD, master)**
    added file4 <userb>
  e404363 - added file3 <userb>
  19abe80 - added file2
  8cb6ba4 - added file1
</userb></userb></pre>
</li>
<li>
<p>At the same time, <span style="color:#6262c5" node="[object Object]">Gaaa</span> makes two commits, so his repository
looks like this:</p>
<pre style="color:#6262c5">  $ git log

  ef5b54f - **(HEAD, master)** added file6 <usera>
  5f7cff8 - added file5 <usera>
  19abe80 - **(origin/master, origin/HEAD)** added file2
  8cb6ba4 - added file1
</usera></usera></pre>
</li>
<li>
<p>When <span style="color:#6262c5" node="[object Object]">Gaaa</span> tries to push his changes, he gets this error:</p>
<pre style="color:#6262c5">  $ git push

  ! [rejected]        master -&gt; master (non-fast-forward)
  error: failed to push some refs to &#x27;...&#x27;
  To prevent you from losing history, non-fast-forward 
  updates were rejected Merge the remote changes 
  (e.g. &#x27;git pull&#x27;) before pushing again.  See the
  &#x27;Note about fast-forwards&#x27; section of 
  &#x27;git push --help&#x27; for details.
</pre>
<p>Git notices that the master branch in the origin repository no longer matches &#x27;origin/master&#x27; so
it won&#x27;t allow the push.</p>
</li>
<li>
<p>To solve this, <span style="color:#6262c5" node="[object Object]">Gaaa</span> first <strong>fetches</strong> the changes from the
origin repository:</p>
<pre style="color:#6262c5">  $ git fetch
  $ git log --graph --all

  * ef5b54f - **(HEAD, master)** added file6 <usera>
  * 5f7cff8 - added file5 <usera>
  | * 07c8c6d - **(origin/master, origin/HEAD)** added file4
  | * e404363 - added file3 <userb>
  |/  
  * 19abe80 - added file2
  * 8cb6ba4 - added file1
</userb></usera></usera></pre>
<p>Adding <strong>--all</strong> to the log command shows commits from all of the branches and adding <strong>--graph</strong>
shows a graphic representation of the branches.</p>
</li>
<li>
<p>The second step is to perform a <strong>rebase</strong> that will update the new commits by
<span style="color:#6262c5" node="[object Object]">Gaaa</span> (ef5b54f and 5f7cff8) so it will appear as if they
were commited after the new &#x27;origin/master&#x27; (07c8c6d).</p>
<p>Since <span style="color:#6262c5" node="[object Object]">Gaaa</span> and <span style="color:#24d024" node="[object Object]">Gaaa</span>&#x27;s
commits involve different files there won&#x27;t be any conflicts (I will talk about conflicts later
on).</p>
<pre style="color:#6262c5">  $ git rebase origin/master

  First, rewinding head to replay your work on top of it...
  Applying: added file5
  Applying: added file6

  $ git log --graph --all

  * 4fca7e8 - **(HEAD, master)** added file6 <usera>
  * 29ea4d2 - added file5 <usera>
  * 07c8c6d - **(origin/master, origin/HEAD)** added file4 <userb>
  * e404363 - added file3 <userb>
  * 19abe80 - added file2
  * 8cb6ba4 - added file1
</userb></userb></usera></usera></pre>
</li>
<li>
<p>Now <span style="color:#6262c5" node="[object Object]">Gaaa</span> can push his changes to the origin repository:</p>
<pre style="color:#6262c5">  $ git push
  $ git log --graph --all

  * 4fca7e8 - **(HEAD, origin/master, origin/HEAD, master)**
              added file6 
  * 29ea4d2 - added file5 <usera>
  * 07c8c6d - added file4 <userb>
  * e404363 - added file3 <userb>
  * 19abe80 - added file2
  * 8cb6ba4 - added file1
</userb></userb></usera></pre>
<p>We now have a clean, linear history :-)</p>
</li>
</ol>
<h2 id="what-happens-when-there-are-conflicts">What happens when there are conflicts?</h2>
<p>Let&#x27;s look at a similar scenario:</p>
<ol>
<li>
<p><span style="color:#24d024" node="[object Object]">Gaaa</span> added a line to file4.txt, commited and pushed:</p>
<pre style="color:#24d024">$ git push
$ git log --graph --all

* e1e4730 - **(HEAD, origin/master, origin/HEAD, master)** 
            added a line to file4 (2 minutes) <userb>
* 4fca7e8 - added file6 <usera>
* 29ea4d2 - added file5 <usera>
...
</usera></usera></userb></pre>
</li>
<li>
<p>At the same time <span style="color:#6262c5" node="[object Object]">Gaaa</span> added a line to file4.txt, and
commited:</p>
<pre style="color:#6262c5">$ git log --graph --all

* 77a6486 - **(HEAD, master)** 
            added another line to file4 <usera>
* 4fca7e8 - **(origin/master, origin/HEAD)** added file6 <usera>
* 29ea4d2 - added file5 <usera>
...
</usera></usera></usera></pre>
</li>
<li>
<p>When <span style="color:#6262c5" node="[object Object]">Gaaa</span> tries to push the changes, he gets the same
error we have seen before. So, he fetches the changes and tries to rebase:</p>
<pre style="color:#6262c5">$ git fetch
$ git rebase origin/master
_First, rewinding head to replay your work on top of it...
Applying: added another line to file4
Using index info to reconstruct a base tree...
Falling back to patching base and 3-way merge...
**Auto-merging file4.txt
CONFLICT (content): Merge conflict in file4.txt
Failed to merge in the changes.
Patch failed at 0001 added another line to file4**

When you have resolved this problem run 
  &quot;git rebase --continue&quot;.
If you would prefer to skip this patch, instead run 
  &quot;git rebase --skip&quot;.
To restore the original branch and stop rebasing run 
  &quot;git rebase --abort&quot;._ 
</pre>
<p>While trying to auto merge file4.txt git reached a conflict and paused the rebase.</p>
<p>If we look at file4.txt we will see the following contents:</p>
<pre>file4
<span style="color:#24d024" node="[object Object]">Gaaa</span>
=======
<span style="color:#6262c5" node="[object Object]">Gaaa</span>
</pre>
</li>
<li>
<p>This is how git handles conflicts, now <span style="color:#6262c5" node="[object Object]">Gaaa</span> can open his
favorite editor (vim) and merge the file manually:</p>
<pre style="color:#6262c5">file4
added a line to file4
added another line to file4
</pre>
</li>
<li>
<p>After merging the file, <span style="color:#6262c5" node="[object Object]">Gaaa</span> must mark the conflict as
solved (by using &quot;git add&quot;) and continue the rebase:</p>
<pre style="color:#6262c5">$ git add file4.txt
$ git rebase --continue

* c8c37cd - **(HEAD, master)** 
            added another line to file4 <usera>
* e1e4730 - **(origin/master, origin/HEAD)** 
            added a line to file4 <userb>
* 4fca7e8 - added file6 <usera>
...
</usera></userb></usera></pre>
</li>
<li>
<p><span style="color:#6262c5" node="[object Object]">Gaaa</span> can now push the changes back to origin:</p>
<pre style="color:#6262c5">$ git push
* c8c37cd - **(HEAD, origin/master, origin/HEAD, master)**
            added another line to file4 <usera>
* e1e4730 - added a line to file4 <userb>
* 4fca7e8 - added file6 <usera>
...
</usera></userb></usera></pre>
<p>And again, we get a clean, linear history.</p>
</li>
</ol>
<p>I hope you find this post useful.</p>
<p>Until the next time, David.</p></div></div><div class="e-post__next"><span>Next:</span><a class="e-post__next" href="/2012/01/solving-coding-problems.html">Solving Coding Problems</a></div></div></body></html>